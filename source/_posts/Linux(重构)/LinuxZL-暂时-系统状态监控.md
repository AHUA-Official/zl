#### uptime
命令返回的信息：

+ 19:08:17 // 系统当前时间
+ up 127 days, 3:00 // 主机已运行时间, 时间越大，说明你的机器越稳定
+ 1 user // 用户连接数，是总连接数而不是用户数
+ load average: 0.00, 0.01, 0.05 // 系统平均负载，统计最近 1，5，15 分钟的系统平均负载

#### 2） dmesg
dmesg 命令被用于检查和控制内核的环形缓冲区。kernel 会将开机信息存储在 ring buffer 中。您若是开机时来不及查看信息，可利用 dmesg 来查看。开机信息保存在 / var/log/dmesg 文件里。

常用选项： -c：显示信息后，清除 ring buffer 中的内容； -s <缓冲区大小>：预设置为 8196，刚好等于 ring buffer 的大小； -n：设置记录信息的层级。

#### 3）vmstat
vmstat 命令的含义为显示虚拟内存状态（“Virtual Memory Statistics”），但是它可以报告关于进程、内存、I/O 等系统整体运行状态。

常用选项： -a：显示活动内页； -f：显示启动后创建的进程总数； -m：显示 slab 信息； -n：头信息仅显示一次； -s：以表格方式显示事件计数器和内存状态； -d：报告磁盘状态； -p：显示指定的硬盘分区状态； -S：输出信息的单位；

输出的信息： **procs（进程）**

+ r: 运行队列中进程数量，这个值也可以判断是否需要增加 CPU。（长期大于 1）；
+ b: 等待 IO 的进程数量；

**memory（内存）**

+ swpd: 使用虚拟内存大小，如果 swpd 的值不为 0，但是 SI，SO 的值长期为 0，这种情况不会影响系统性能；
+ free: 空闲物理内存大小；
+ buff: 用作缓冲的内存大小；
+ cache: 用作缓存的内存大小，如果 cache 的值大的时候，说明 cache 处的文件数多，如果频繁访问到的文件都能被 cache 处，那么磁盘的读 IO bi 会非常小；

**swap（交换分区）**

+ si: 每秒从交换区写到内存的大小，由磁盘调入内存；
+ so: 每秒写入交换区的内存大小，由内存调入磁盘； 注意：内存够用的时候，这 2 个值都是 0，如果这 2 个值长期大于 0 时，系统性能会受到影响，磁盘 IO 和 CPU 资源都会被消耗。有些朋友看到空闲内存（free）很少的或接近于 0 时，就认为内存不够用了，不能光看这一点，还要结合 si 和 so，如果 free 很少，但是 si 和 so 也很少（大多时候是 0），那么不用担心，系统性能这时不会受到影响的。

**io（现在的 Linux 版本块的大小为 1kb）**

+ bi: 每秒读取的块数；
+ bo: 每秒写入的块数； 注意：随机磁盘读写的时候，这 2 个值越大（如超出 1024k)，能看到 CPU 在 IO 等待的值也会越大。

**system（系统）**

+ in: 每秒中断数，包括时钟中断；
+ cs: 每秒上下文切换数； 注意：上面 2 个值越大，会看到由内核消耗的 CPU 时间会越大。

**cpu（以百分比表示）**

+ us: 用户进程执行时间百分比； us 的值比较高时，说明用户进程消耗的 CPU 时间多，但是如果长期超 50% 的使用，那么我们就该考虑优化程序算法或者进行加速。
+ sy: 内核系统进程执行时间百分比； sy 的值高时，说明系统内核消耗的 CPU 资源多，这并不是良性表现，我们应该检查原因。
+ wa: IO 等待时间百分比 wa 的值高时，说明 IO 等待比较严重，这可能由于磁盘大量作随机访问造成，也有可能磁盘出现瓶颈（块操作）。
+ id: 空闲时间百分比

#### 4）mpstat
mpstat 命令指令主要用于多 CPU 环境下，它显示各个可用 CPU 的状态信息。这些信息存放在 / proc/stat 文件中。在多 CPUs 系统里，其不但能查看所有 CPU 的平均状况信息，而且能够查看特定 CPU 的信息。

#### 5）pidstat
pidstat 用于打印各个进程对 CPU 的占用情况，类似 top 命令中显示的内容。pidstat 的优势在于，可以滚动的打印进程运行情况，而不像 top 那样会清屏。

#### 6）iostat
iostat 命令被用于监视系统输入输出设备和 CPU 的使用情况。它的特点是汇报磁盘活动统计情况，同时也会汇报出 CPU 使用情况。同 vmstat 一样，iostat 也有一个弱点，就是它不能对某个进程进行深入分析，仅对系统的整体情况进行分析。

常用选项： -c：仅显示 CPU 使用情况； -d：仅显示设备利用率； -k：显示状态以千字节每秒为单位，而不使用块每秒； -m：显示状态以兆字节每秒为单位； -p：仅显示块设备和所有被使用的其他分区的状态； -t：显示每个报告产生时的时间； -V：显示版号并退出； -x：显示扩展状态。

详细说明：第二行是系统信息和监测时间，第三行和第四行显示 CPU 使用情况（具体内容和 mpstat 命令相同）。这里主要关注后面 I/O 输出的信息，如下所示：

+ Device：监测设备名称
+ rrqm/s：每秒需要读取需求的数量
+ wrqm/s：每秒需要写入需求的数量
+ r/s：每秒实际读取需求的数量
+ w/s：每秒实际写入需求的数量
+ rsec/s：每秒读取区段的数量
+ wsec/s：每秒写入区段的数量
+ rkB/s：每秒实际读取的大小，单位为 KB
+ wkB/s：每秒实际写入的大小，单位为 KB
+ avgrq-sz：需求的平均大小区段
+ avgqu-sz：需求的平均队列长度
+ await：等待 I/O 平均的时间（milliseconds）
+ svctm：I/O 需求完成的平均时间
+ %util：被 I/O 需求消耗的 CPU 百分比

#### 7）free
free 命令可以显示当前系统未使用的和已使用的内存数目，还可以显示被内核使用的内存缓冲区。

常用选项： -b：以 Byte 为单位显示内存使用情况； -k：以 KB 为单位显示内存使用情况； -m：以 MB 为单位显示内存使用情况； -o：不显示缓冲区调节列； -s <间隔秒数>：持续观察内存使用状况； -t：显示内存总和列； -V：显示版本信息。

返回信息： total：内存总数； used：已经使用的内存数； free：空闲的内存数； shared：当前已经废弃不用； buffers Buffer：缓存内存数； available 还可以被 应用程序 使用的物理内存大小；

#### 8）sar
sar 命令是 Linux 下系统运行状态统计工具，它将指定的操作系统状态计数器显示到标准输出设备。sar 工具将对系统当前的状态进行取样，然后通过计算数据和比例来表达系统的当前运行状态。它的特点是可以连续对系统取样，获得大量的取样数据。取样数据和分析的结果都可以存入文件，使用它时消耗的系统资源很小。

常用选项： -A：显示所有的报告信息； -b：显示 I/O 速率； -B：显示换页状态； -c：显示进程创建活动； -d：显示每个块设备的状态； -e：设置显示报告的结束时间； -f：从指定文件提取报告； -i：设状态信息刷新的间隔时间； -P：报告每个 CPU 的状态； -R：显示内存状态； -u：显示 CPU 利用率； -v：显示索引节点，文件和其他内核表的状态； -w：显示交换分区状态； -x：显示给定进程的状态；

返回信息： IFACE ，网络接口名称； rxpck/s ，每秒接收到包数； txpck/s ，每秒传输的报数；(transmit packages) rxkB/s ，每秒接收的千字节数； txkB/s ，每秒发送的千字节数； rxcmp/s ，每秒接收的压缩包的数量； txcmp/s ，每秒发送的压缩包的数量； rxmcst/s，每秒接收的组数据包数量；

返回信息： active/s：发起的网络连接数量； passive/s：接收的网络连接数量； retrans/s：重传的数量；

#### 9）top
top 命令可以实时动态地查看系统的整体运行情况，是一个综合了多方信息监测系统性能和运行信息的实用工具。通过 top 命令所提供的互动式界面，用热键可以管理。

常用选项： -b：以批处理模式操作； -c：显示完整的治命令； -d：屏幕刷新间隔时间； -I：忽略失效过程； -s：保密模式； -S：累积模式； -i <时间>：设置间隔时间； -u < 用户名 >：指定用户名； -p < 进程号 >：指定进程； -n < 次数 >：循环显示的次数；

top 交互命令： h：显示帮助画面，给出一些简短的命令总结说明； k：终止一个进程； i：忽略闲置和僵死进程，这是一个开关式命令； q：退出程序； r：重新安排一个进程的优先级别； S：切换到累计模式； s：改变两次刷新之间的延迟时间（单位为 s），如果有小数，就换算成 ms。输入 0 值则系统将不断刷新，默认值是 5s； f 或者 F：从当前显示中添加或者删除项目； o 或者 O：改变显示项目的顺序； l：切换显示平均负载和启动时间信息； m：切换显示内存信息； t：切换显示进程和 CPU 状态信息； c：切换显示命令名称和完整命令行； M：根据驻留内存大小进行排序； P：根据 CPU 使用百分比大小进行排序； T：根据时间 / 累计时间进行排序； w：将当前设置写入~/.toprc 文件中;

返回信息：

+ top - 09:44:56[当前系统时间],
+ 16 days[系统已经运行了 16 天],
+ 1 user[个用户当前登录],
+ load average: 9.59, 4.75, 1.92[系统负载，即任务队列的平均长度]
+ Tasks: 145 total[总进程数],
+ 2 running[正在运行的进程数],
+ 143 sleeping[睡眠的进程数],
+ 0 stopped[停止的进程数],
+ 0 zombie[冻结进程数],
+ Cpu(s): 99.8%us[用户空间占用 CPU 百分比],
+ 0.1%sy[内核空间占用 CPU 百分比],
+ 0.0%ni[用户进程空间内改变过优先级的进程占用 CPU 百分比],
+ 0.2%id[空闲 CPU 百分比], 0.0%wa[等待输入输出的 CPU 时间百分比],
+ 0.0%hi[],
+ 0.0%st[],
+ Mem: 4147888k total[物理内存总量],
+ 2493092k used[使用的物理内存总量],
+ 1654796k free[空闲内存总量],
+ 158188k buffers[用作内核缓存的内存量]
+ Swap: 5144568k total[交换区总量],
+ 56k used[使用的交换区总量],
+ 5144512k free[空闲交换区总量],
+ 2013180k cached[缓冲的交换区总量],

## **<font style="color:rgb(38, 38, 38);">在基于 Linux 的系统上查看 CPU 温度和频率的小脚本</font>**
```json
#!/usr/bin/env bash

grep --color=never 'cpu MHz' /proc/cpuinfo
cpu_temp=$(($(cat /sys/class/thermal/thermal_zone0/temp) / 1000))
echo "cpu temperature : ${cpu_temp}"
```



1. **<font style="color:rgb(44, 44, 54);">查看CPU信息</font>**<font style="color:rgb(44, 44, 54);">:</font>
    - <font style="color:rgb(44, 44, 54);">使用</font><font style="color:rgb(44, 44, 54);">lscpu</font><font style="color:rgb(44, 44, 54);">命令可以获取CPU的详细信息，如架构、字长、核心数等。</font>
    - <font style="color:rgb(44, 44, 54);">cat /proc/cpuinfo</font><font style="color:rgb(44, 44, 54);">提供更详细的CPU信息，包括每个核心的具体情况。</font>
2. **<font style="color:rgb(44, 44, 54);">查看内存使用情况</font>**<font style="color:rgb(44, 44, 54);">:</font>
    - <font style="color:rgb(44, 44, 54);">free -h</font><font style="color:rgb(44, 44, 54);">以易读的格式显示内存使用情况，包括物理内存和交换空间。</font>
    - <font style="color:rgb(44, 44, 54);">top</font><font style="color:rgb(44, 44, 54);">或</font><font style="color:rgb(44, 44, 54);">htop</font><font style="color:rgb(44, 44, 54);">(如果已安装)可以实时查看各进程的资源占用，包括CPU和内存。</font>
3. **<font style="color:rgb(44, 44, 54);">查看磁盘使用情况</font>**<font style="color:rgb(44, 44, 54);">:</font>
    - <font style="color:rgb(44, 44, 54);">df -h</font><font style="color:rgb(44, 44, 54);">查看各文件系统的磁盘空间使用情况。</font>
    - <font style="color:rgb(44, 44, 54);">du -sh *</font><font style="color:rgb(44, 44, 54);">查看当前目录下各文件及子目录的磁盘使用量。</font>
4. **<font style="color:rgb(44, 44, 54);">查看系统整体负载和运行时间</font>**<font style="color:rgb(44, 44, 54);">:</font>
    - <font style="color:rgb(44, 44, 54);">uptime</font><font style="color:rgb(44, 44, 54);">显示系统运行时间、当前用户数以及平均负载。</font>
5. **<font style="color:rgb(44, 44, 54);">检查网络状态</font>**<font style="color:rgb(44, 44, 54);">:</font>
    - <font style="color:rgb(44, 44, 54);">ifconfig</font><font style="color:rgb(44, 44, 54);">或</font><font style="color:rgb(44, 44, 54);">ip addr show</font><font style="color:rgb(44, 44, 54);">查看网络接口配置和IP地址。</font>
    - <font style="color:rgb(44, 44, 54);">netstat -tuln</font><font style="color:rgb(44, 44, 54);">查看打开的端口和监听状态。</font>
6. **<font style="color:rgb(44, 44, 54);">查看系统内核版本和其他系统信息</font>**<font style="color:rgb(44, 44, 54);">:</font>
    - <font style="color:rgb(44, 44, 54);">uname -a</font><font style="color:rgb(44, 44, 54);">显示内核版本、主机名等系统信息。</font>
7. **<font style="color:rgb(44, 44, 54);">硬件信息</font>**<font style="color:rgb(44, 44, 54);">:</font>
    - <font style="color:rgb(44, 44, 54);">对于更详细的硬件配置，可以使用lshw(需要安装)或dmidecode(需要root权限)命令。</font>

## <font style="color:rgb(44, 44, 54);">硬盘</font>
1. `**lsblk**`：列出所有可用的块设备（包括硬盘）。

```plain
bash

lsblk
```

这个命令会显示设备名称、挂载点、分区大小等信息。

2. `**fdisk**`：查看磁盘分区表。

```plain
bash

sudo fdisk -l
```

这个命令会列出所有磁盘的分区信息，包括磁盘大小、分区类型等。

3. `**parted**`：另一个查看磁盘分区的工具。

```plain
bash

sudo parted -l
```

这个命令会显示磁盘的分区信息，包括磁盘大小和分区大小。

4. `**df**`：查看文件系统的磁盘空间使用情况。

```plain
bash

df -h
```

这个命令会以易读的格式（如MB、GB）显示文件系统的使用情况。

5. `**smartctl**`：查看S.M.A.R.T.信息，用于检查硬盘的健康状况。

```plain
bash

sudo smartctl -a /dev/sda
```

这个命令会显示硬盘的S.M.A.R.T.信息，包括温度、使用时间、读写错误等。

6. `**hdparm**`：查看硬盘参数和性能。

```plain
bash

sudo hdparm -I /dev/sda
```

这个命令会显示硬盘的物理参数和性能信息。

7. `**iostat**`：查看硬盘I/O统计信息。

```plain
bash

iostat
```

这个命令会显示硬盘的I/O统计信息，包括读写速度和I/O等待时间。

8. `**nvme**`：如果你使用的是NVMe SSD，这个命令可以查看NVMe设备的详细信息。

```plain
bash

sudo nvme list
```

这个命令会列出所有NVMe设备及其状态。

9. `**lscpu**`：虽然这个命令主要用于查看CPU信息，但它也可以显示与硬盘接口相关的CPU特性。

```plain
bash

lscpu
```

10. `**dmesg**`：查看内核消息，有时可以找到硬盘相关的信息。

```plain
bash复制

dmesg | grep -i disk
```

## CPU
CPU监控脚本

使用mpstat  + tee   把 mpstat  -P   ALL   3   的输出    使用可变参数num    和   parameter  来控制输出  

mpstat   -p ALL   3  的输出是这个样子的 

```python
09:22:28 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
09:22:31 PM  all    0.15    0.00    0.00    0.00    0.04    0.04    0.00    0.00    0.00   99.77
09:22:31 PM    0    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
09:22:31 PM    1    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
09:22:31 PM    2    0.33    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.67
09:22:31 PM    3    0.00    0.00    0.00    0.00    0.33    0.00    0.00    0.00    0.00   99.67
09:22:31 PM    4    0.33    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.67
09:22:31 PM    5    0.00    0.00    0.00    0.00    0.33    0.33    0.00    0.00    0.00   99.33
09:22:31 PM    6    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
09:22:31 PM    7    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
09:22:31 PM    8    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
09:22:31 PM    9    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
09:22:31 PM   10    0.33    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.67
09:22:31 PM   11    0.33    0.00    0.00    0.00    0.00    0.33    0.00    0.00    0.00   99.34
09:22:31 PM   12    0.33    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.67
09:22:31 PM   13    0.33    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.67
09:22:31 PM   14    0.33    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.67
09:22:31 PM   15    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00

```

num 起到的作用是  筛选 cpu的num     是字符串参数

 parameter   起到的作用是筛选    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice 这样的参数   可以多选  



![](https://cdn.nlark.com/yuque/0/2024/png/39116304/1730685778200-83f54f3c-9c7c-4db4-8bd4-edf4833be7bb.png)

```python
mpstat  -P   ALL   3  | grep  3 
```

